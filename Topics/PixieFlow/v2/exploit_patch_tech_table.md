# Netboot Security: Exploitation & Patching Technologies - Complete Reference

---

## TABLE 1: EXPLOITATION TECHNOLOGIES & ATTACK METHODS

| # | Attack Type | Technology/Tool | Purpose | How It Works | Risk Level |
|---|---|---|---|---|---|
| **1** | **Network MITM** | ARP Spoofing | Intercept network traffic | `arpspoof` tool sends crafted ARP packets to poison ARP cache | ðŸ”´ CRITICAL |
| **2** | **Network MITM** | tcpdump | Packet capture & analysis | Captures layer 2-4 packets for traffic inspection | ðŸ”´ CRITICAL |
| **3** | **Network MITM** | Wireshark | GUI packet analysis | Visual protocol analyzer for DHCP/TFTP/NFS inspection | ðŸŸ  HIGH |
| **4** | **DHCP Attack** | dnsmasq | Rogue DHCP server | Lightweight DHCP/DNS server to serve malicious boot options | ðŸ”´ CRITICAL |
| **5** | **DHCP Attack** | ISC DHCP | Alternative DHCP server | Full-featured DHCP server for option injection | ðŸ”´ CRITICAL |
| **6** | **DHCP Attack** | dhcpig | DHCP exhaustion | Floods DHCP pool with DISCOVER packets to starve IPs | ðŸŸ  HIGH |
| **7** | **DHCP Attack** | scapy (Python) | DHCP packet crafting | Low-level packet creation in Python for custom DHCP payloads | ðŸ”´ CRITICAL |
| **8** | **TFTP Attack** | in.tftpd | Rogue TFTP server | Standard TFTP daemon serving malicious boot files | ðŸ”´ CRITICAL |
| **9** | **TFTP Attack** | Python socket | TFTP protocol implementation | Raw socket programming for TFTP MITM | ðŸ”´ CRITICAL |
| **10** | **TFTP Attack** | netcat (nc) | File transfer intercept | Simple TCP/UDP data relay for MITM | ðŸŸ  HIGH |
| **11** | **File Compromise** | gunzip + cpio | Initrd extraction | Decompress and extract cpio archive format | ðŸ”´ CRITICAL |
| **12** | **File Compromise** | unsquashfs | Squashfs extraction | Extract read-only filesystem images | ðŸ”´ CRITICAL |
| **13** | **File Compromise** | mksquashfs | Squashfs repackaging | Create new squashfs with malicious files injected | ðŸ”´ CRITICAL |
| **14** | **File Compromise** | cpio | Initrd repackaging | Repackage cpio archive after modification | ðŸ”´ CRITICAL |
| **15** | **File Compromise** | gcc | Backdoor compilation | Compile backdoor code to executable binaries | ðŸ”´ CRITICAL |
| **16** | **File Compromise** | ld (linker) | Shared library creation | Create LD_PRELOAD backdoor libraries | ðŸ”´ CRITICAL |
| **17** | **File Compromise** | sed | Script modification | In-place file editing to inject malicious code | ðŸ”´ CRITICAL |
| **18** | **Bootloader Attack** | GRUB configuration | Menu manipulation | Modify grub.cfg to add backdoor boot entries | ðŸ”´ CRITICAL |
| **19** | **Bootloader Attack** | pxelinux.cfg | Menu injection | Alter pxelinux boot configuration | ðŸ”´ CRITICAL |
| **20** | **Privilege Escalation** | SUID binaries | Root access | Create setuid shell for unprivileged users to gain root | ðŸ”´ CRITICAL |
| **21** | **Privilege Escalation** | Sudoers config | Sudo bypass | Add backdoor user to sudoers without password | ðŸ”´ CRITICAL |
| **22** | **Persistence** | Systemd services | Service-based backdoor | Create .service file to auto-run malicious code at boot | ðŸ”´ CRITICAL |
| **23** | **Persistence** | rc.local | Init script modification | Add backdoor to /etc/rc.local for early execution | ðŸ”´ CRITICAL |
| **24** | **Persistence** | Cron jobs | Scheduled backdoor | Schedule reverse shells via crontab entries | ðŸ”´ CRITICAL |
| **25** | **Persistence** | LD_PRELOAD | Library injection | Hook system calls via shared library injection | ðŸ”´ CRITICAL |
| **26** | **Persistence** | .bashrc/.profile | Shell initialization | Inject backdoor into shell startup files | ðŸ”´ CRITICAL |
| **27** | **Covert Communication** | netcat | Reverse shell | Simple TCP/UDP reverse shell connection | ðŸ”´ CRITICAL |
| **28** | **Covert Communication** | socat | Advanced reverse shell | Encrypted/tunneled reverse shell over TLS | ðŸ”´ CRITICAL |
| **29** | **Covert Communication** | SSH backdoor | Remote access | Inject SSH keys for passwordless backdoor access | ðŸ”´ CRITICAL |
| **30** | **Data Exfiltration** | tar + nc | Data compression & transfer | Compress and exfiltrate data via network | ðŸ”´ CRITICAL |
| **31** | **Data Exfiltration** | curl/wget | HTTP exfiltration | Upload stolen data to attacker server | ðŸ”´ CRITICAL |
| **32** | **Log Hiding** | null redirection | Output suppression | Redirect stdout/stderr to /dev/null | ðŸŸ  HIGH |
| **33** | **Log Hiding** | auditctl -D | Audit cleanup | Delete audit logs to hide activities | ðŸŸ  HIGH |
| **34** | **Log Hiding** | logrotate manipulation | Log rotation bypass | Interfere with log rotation mechanisms | ðŸŸ  HIGH |
| **35** | **Kernel Module** | insmod/modprobe | Rootkit loading | Load malicious kernel modules at boot | ðŸ”´ CRITICAL |
| **36** | **Kernel Module** | gcc (kernel module) | Rootkit compilation | Compile kernel module with malicious code | ðŸ”´ CRITICAL |
| **37** | **NFS Attack** | showmount | Export enumeration | Enumerate NFS shares and permissions | ðŸŸ  HIGH |
| **38** | **NFS Attack** | mount -t nfs | Export mounting | Mount NFS export to access/modify files | ðŸ”´ CRITICAL |
| **39** | **NFS Attack** | chown/chmod | Permission manipulation | Change file ownership to root (if no_root_squash) | ðŸ”´ CRITICAL |
| **40** | **Network Sniffer** | tcpdump | Traffic capture | Capture and analyze network traffic | ðŸ”´ CRITICAL |
| **41** | **Network Sniffer** | nmap | Service enumeration | Scan for open ports and services | ðŸŸ  HIGH |
| **42** | **Network Sniffer** | arpwatch | ARP monitoring | Monitor ARP traffic for spoofing detection | ðŸŸ  HIGH |

---

## TABLE 2: PATCHING & HARDENING TECHNOLOGIES

| # | Security Category | Technology/Tool | Purpose | Implementation | Priority |
|---|---|---|---|---|---|
| **1** | **Integrity Monitoring** | sha256sum | File hashing | Create checksums of critical files | ðŸ”´ CRITICAL |
| **2** | **Integrity Monitoring** | AIDE (Advanced Intrusion Detection Environment) | File integrity database | Build baseline and detect file changes | ðŸ”´ CRITICAL |
| **3** | **Integrity Monitoring** | Tripwire | Enterprise integrity monitoring | Advanced file integrity verification | ðŸŸ  HIGH |
| **4** | **Integrity Monitoring** | auditctl | Kernel audit framework | Monitor file access at syscall level | ðŸ”´ CRITICAL |
| **5** | **Integrity Monitoring** | ausearch | Audit log analysis | Query and analyze audit logs | ðŸ”´ CRITICAL |
| **6** | **Cryptographic Signing** | GPG (GNU Privacy Guard) | Digital signatures | Sign critical files with private key | ðŸ”´ CRITICAL |
| **7** | **Cryptographic Signing** | openssl | Certificate generation | Create self-signed certificates | ðŸ”´ CRITICAL |
| **8** | **Cryptographic Signing** | grub-mkpasswd-pbkdf2 | PBKDF2 hashing | Create password-protected GRUB entries | ðŸ”´ CRITICAL |
| **9** | **Encryption in Transit** | HTTPS/TLS 1.3 | Traffic encryption | Encrypt boot file delivery | ðŸ”´ CRITICAL |
| **10** | **Encryption in Transit** | nginx | Web server with SSL | Serve boot files over HTTPS | ðŸ”´ CRITICAL |
| **11** | **Encryption in Transit** | Apache mod_ssl | Apache SSL support | Alternative HTTPS server | ðŸŸ  HIGH |
| **12** | **Encryption in Transit** | OpenVPN | VPN tunneling | Encrypt all netboot traffic | ðŸŸ  HIGH |
| **13** | **Access Control** | UFW (Uncomplicated Firewall) | Host firewall | Simple firewall rule management | ðŸ”´ CRITICAL |
| **14** | **Access Control** | iptables | Linux kernel firewall | Low-level firewall rules | ðŸ”´ CRITICAL |
| **15** | **Access Control** | AppArmor | Mandatory access control | Profile-based system call restrictions | ðŸŸ  HIGH |
| **16** | **Access Control** | SELinux | Mandatory access control | Context-based security policy | ðŸŸ  HIGH |
| **17** | **Access Control** | chown/chmod | Unix permissions | Restrict file ownership and permissions | ðŸ”´ CRITICAL |
| **18** | **Access Control** | sudo | Privilege escalation control | Limit root access via sudoers rules | ðŸ”´ CRITICAL |
| **19** | **Network Segmentation** | VLAN tagging (netplan) | Network isolation | Separate netboot traffic to dedicated VLAN | ðŸ”´ CRITICAL |
| **20** | **Network Segmentation** | Switch VLAN | Hardware-based isolation | Configure switch ports for VLAN membership | ðŸ”´ CRITICAL |
| **21** | **Network Segmentation** | DHCP Snooping | DHCP validation | Block rogue DHCP on managed switch | ðŸ”´ CRITICAL |
| **22** | **Network Segmentation** | Dynamic ARP Inspection | ARP spoofing prevention | Verify ARP replies at switch level | ðŸ”´ CRITICAL |
| **23** | **Network Segmentation** | MAC address filtering | Port-level access control | Allow only authorized MACs on ports | ðŸŸ  HIGH |
| **24** | **Secure Boot** | UEFI Secure Boot | Bootloader verification | Cryptographically verify bootloader signature | ðŸ”´ CRITICAL |
| **25** | **Secure Boot** | Measured Boot (TPM) | Boot integrity measurement | Store boot hashes in TPM | ðŸ”´ CRITICAL |
| **26** | **Secure Boot** | GRUB password | Boot menu protection | Password-protect dangerous boot options | ðŸ”´ CRITICAL |
| **27** | **Secure Boot** | shim + GRUB | Secure chain of trust | Establish verified boot chain | ðŸ”´ CRITICAL |
| **28** | **Secure Boot** | Kernel module signing | Module verification | Sign kernel modules with private key | ðŸ”´ CRITICAL |
| **29** | **Kernel Hardening** | sysctl | Runtime kernel parameters | Disable dangerous kernel features | ðŸ”´ CRITICAL |
| **30** | **Kernel Hardening** | kernel.sysrq=0 | Magic SysRq disable | Prevent emergency keyboard access | ðŸ”´ CRITICAL |
| **31** | **Kernel Hardening** | kernel.modules_disabled=1 | Module loading lock | Prevent runtime module loading | ðŸ”´ CRITICAL |
| **32** | **Kernel Hardening** | kernel.kexec_load_disabled=1 | Kexec prevention | Disable kernel replacement | ðŸ”´ CRITICAL |
| **33** | **Kernel Hardening** | kernel.kptr_restrict=2 | Kernel pointer hiding | Prevent information leakage | ðŸŸ  HIGH |
| **34** | **Kernel Hardening** | kernel.yama.ptrace_scope=2 | Ptrace restriction | Restrict debugging capabilities | ðŸŸ  HIGH |
| **35** | **Kernel Hardening** | kernel.perf_event_paranoid=3 | Performance event restriction | Limit performance monitoring | ðŸŸ  HIGH |
| **36** | **Logging & Monitoring** | syslog/rsyslog | Centralized logging | Collect system logs remotely | ðŸ”´ CRITICAL |
| **37** | **Logging & Monitoring** | auditd | Audit daemon | Continuous system call logging | ðŸ”´ CRITICAL |
| **38** | **Logging & Monitoring** | journalctl | Systemd journal queries | Query structured logs | ðŸŸ  HIGH |
| **39** | **Logging & Monitoring** | fail2ban | Intrusion prevention | Auto-block suspicious activities | ðŸŸ  HIGH |
| **40** | **Logging & Monitoring** | OSSEC | Host-based IDS | Detect intrusions and file changes | ðŸŸ  HIGH |
| **41** | **Logging & Monitoring** | Splunk | SIEM platform | Centralized security event analysis | ðŸŸ  HIGH |
| **42** | **Logging & Monitoring** | ELK Stack | Log aggregation | Elasticsearch, Logstash, Kibana | ðŸŸ  HIGH |
| **43** | **File Verification** | fsck | Filesystem check | Verify filesystem integrity | ðŸŸ¡ MEDIUM |
| **44** | **File Verification** | dm-verity | Device mapper verification | Cryptographically verify block device | ðŸ”´ CRITICAL |
| **45** | **File Verification** | IMA (Integrity Measurement Architecture) | Boot-time measurement | Measure files into TPM | ðŸ”´ CRITICAL |
| **46** | **File Verification** | EVM (Extended Verification Module) | Extended verification | Verify file metadata integrity | ðŸŸ  HIGH |
| **47** | **Root Filesystem Security** | overlayfs | Overlay filesystem | Separate read-only base from writable layer | ðŸ”´ CRITICAL |
| **48** | **Root Filesystem Security** | mount -o ro,noexec,nosuid | Filesystem hardening | Mount options to prevent code execution | ðŸ”´ CRITICAL |
| **49** | **Root Filesystem Security** | AppArmor profiles | Fine-grained access control | Restrict application capabilities | ðŸŸ  HIGH |
| **50** | **Root Filesystem Security** | seccomp | Syscall filtering | Restrict available system calls | ðŸŸ  HIGH |
| **51** | **Configuration Management** | Ansible | Infrastructure as code | Automate hardening deployment | ðŸŸ  HIGH |
| **52** | **Configuration Management** | Puppet | Configuration management | Enforce consistent security policies | ðŸŸ  HIGH |
| **53** | **Configuration Management** | Chef | Infrastructure automation | Codify security configurations | ðŸŸ  HIGH |
| **54** | **Vulnerability Scanning** | OpenVAS | Vulnerability scanner | Automated security scanning | ðŸŸ  HIGH |
| **55** | **Vulnerability Scanning** | Nessus | Commercial scanner | Professional vulnerability assessment | ðŸŸ  HIGH |
| **56** | **Vulnerability Scanning** | lynis | Security auditing tool | Compliance and security checks | ðŸŸ  HIGH |
| **57** | **Vulnerability Scanning** | checksec | Security hardening check | Verify kernel protections | ðŸŸ¡ MEDIUM |
| **58** | **Bootloader Security** | grub-editenv | GRUB variable management | Set GRUB environment variables securely | ðŸŸ¡ MEDIUM |
| **59** | **Bootloader Security** | efibootmgr | UEFI boot manager | Manage UEFI boot entries securely | ðŸ”´ CRITICAL |
| **60** | **Bootloader Security** | mokutil | MOK management | Manage Machine Owner Key for Secure Boot | ðŸŸ  HIGH |
| **61** | **Network Authentication** | Kerberos | Network authentication | Secure DHCP/NFS authentication | ðŸ”´ CRITICAL |
| **62** | **Network Authentication** | NTPsec | Secure NTP | Prevent time-based attacks | ðŸŸ¡ MEDIUM |
| **63** | **Network Authentication** | RADIUS | Authentication server | Centralized network access control | ðŸŸ  HIGH |
| **64** | **Compliance Verification** | OpenSCAP | Compliance scanning | Verify against security standards (NIST, CIS) | ðŸŸ  HIGH |
| **65** | **Compliance Verification** | CIS-CAT | Benchmark validator | Check CIS benchmark compliance | ðŸŸ  HIGH |

---

## TABLE 3: COMPARATIVE TECHNOLOGIES (Exploit vs Patch)

| Attack Technique | Exploit Tool | Patching/Detection Tool | Effectiveness |
|---|---|---|---|
| **File Modification** | gunzip + cpio + sed | sha256sum + AIDE + auditctl | âœ… Excellent |
| **DHCP Spoofing** | dnsmasq (rogue) | DHCP Snooping + DAI | âœ… Good |
| **TFTP Hijacking** | in.tftpd (rogue) | GPG signatures + HTTPS | âœ… Excellent |
| **Bootloader Tampering** | GRUB cfg edit | GRUB password + dm-verity | âœ… Excellent |
| **Privilege Escalation** | SUID binaries | kernel.modules_disabled + SELinux | âœ… Good |
| **Persistence via Services** | systemd .service | auditctl + fail2ban | âœ… Good |
| **Covert Communication** | netcat reverse shell | UFW + Network monitoring | âœ… Good |
| **Log Hiding** | auditctl -D | Remote syslog + immutable logs | âœ… Excellent |
| **Kernel Module Injection** | insmod + .ko | Module signing + kernel.modules_disabled | âœ… Excellent |
| **NFS Compromise** | mount + chmod | NFS Kerberos + export restrictions | âœ… Good |

---

## TABLE 4: TECHNOLOGY STACK BREAKDOWN

### **ATTACK TECHNOLOGIES**

**Layer 1: Network**
- `arpspoof` - ARP spoofing
- `tcpdump` - Packet capture
- `nmap` - Service enumeration
- `nc/netcat` - Network communication
- `scapy` - Packet crafting (Python)

**Layer 2: DHCP/Boot**
- `dnsmasq` - Rogue DHCP server
- `ISC DHCP` - Alternative DHCP
- `dhcpig` - DHCP flooding
- `pxelinux` - Boot manipulation

**Layer 3: TFTP/File Delivery**
- `in.tftpd` - Rogue TFTP
- `Python sockets` - Custom TFTP
- `netcat` - File transfer

**Layer 4: File Manipulation**
- `gunzip` - Archive decompression
- `cpio` - Archive manipulation
- `unsquashfs` - SquashFS extraction
- `mksquashfs` - SquashFS repackaging
- `gcc` - Backdoor compilation
- `sed` - Script injection

**Layer 5: Persistence**
- `systemd` - Service-based backdoors
- `cron` - Scheduled execution
- `LD_PRELOAD` - Library injection
- `ssh` - Backdoor access

**Layer 6: Post-Exploitation**
- `tar + nc` - Data exfiltration
- `curl/wget` - Data upload
- Reverse shells - Remote command execution

---

### **PATCHING TECHNOLOGIES**

**Layer 1: Detection**
- `sha256sum` - File hashing
- `AIDE` - Integrity database
- `auditctl` - Kernel auditing
- `arpwatch` - ARP monitoring

**Layer 2: Cryptography**
- `GPG` - Digital signatures
- `openssl` - Certificates
- `grub-mkpasswd-pbkdf2` - Password hashing
- `TLS 1.3` - Encryption

**Layer 3: Access Control**
- `UFW/iptables` - Firewall
- `AppArmor/SELinux` - MAC
- `chmod/chown` - Permissions
- `VLAN` - Network isolation

**Layer 4: Secure Boot**
- `UEFI Secure Boot` - Bootloader verification
- `TPM/Measured Boot` - Integrity verification
- `GRUB password` - Menu protection
- `Kernel module signing` - Module verification

**Layer 5: Kernel Hardening**
- `sysctl` - Kernel parameters
- `kernel.modules_disabled` - Module locking
- `kernel.kexec_load_disabled` - Kexec prevention
- `Security namespaces` - Container isolation

**Layer 6: Monitoring**
- `rsyslog` - Log aggregation
- `auditd` - System auditing
- `fail2ban` - Intrusion prevention
- `OSSEC/Splunk` - SIEM

---

## TABLE 5: EXPLOITATION PHASES & CORRESPONDING TECHNOLOGIES

| Phase | Attack Objective | Primary Tools Used | Supporting Tools | Detection Method |
|---|---|---|---|---|
| **Phase 1: Reconnaissance** | Identify netboot infrastructure | `nmap`, `arpwatch`, `tcpdump` | `nmapsh`, DNS enumeration | Network scanning logs |
| **Phase 2: Network Access** | Gain MITM position | `arpspoof`, `ettercap` | `dsniff`, netcat | ARP inconsistencies |
| **Phase 3: DHCP Hijacking** | Intercept boot information | `dnsmasq`, `scapy` | DHCP option injection | Multiple DHCP servers |
| **Phase 4: TFTP Interception** | Serve malicious files | `in.tftpd`, Python TFTP | `netcat` relay | TFTP transfer logs |
| **Phase 5: Initrd Compromise** | Inject backdoor code | `gunzip`, `cpio`, `sed`, `gcc` | `LD_PRELOAD`, shell scripts | File size increase |
| **Phase 6: SquashFS Compromise** | Embed malicious OS | `unsquashfs`, `mksquashfs` | `chmod`, user modification | Hash verification |
| **Phase 7: Bootloader Manipulation** | Ensure persistence | `grub.cfg` edit, kernel parameters | Boot environment modification | Config file changes |
| **Phase 8: System Compromise** | Execute malicious code | `systemd`, `cron`, reverse shells | SSH backdoor, LD_PRELOAD | Process/service monitoring |
| **Phase 9: Data Exfiltration** | Steal credentials/data | `tar`, `nc`, `curl` | Compression, encryption bypass | Network traffic analysis |
| **Phase 10: Log Hiding** | Cover tracks | `auditctl -D`, `/dev/null` redirection | Log manipulation, clearing | Immutable logs |

---

## TABLE 6: REQUIRED LINUX PACKAGES FOR EXPLOITATION

```bash
# Exploitation tools installation
sudo apt install dnsmasq           # Rogue DHCP server
sudo apt install tftpd-hpa         # Rogue TFTP server
sudo apt install dsniff            # ARP spoofing tools
sudo apt install netcat-openbsd    # Network relay
sudo apt install squashfs-tools    # SquashFS manipulation
sudo apt install build-essential   # GCC for backdoor compilation
sudo apt install python3           # Scapy packet crafting
sudo apt install git               # Clone tools

# Patching tools installation
sudo apt install aide              # File integrity
sudo apt install auditd            # Kernel auditing
sudo apt install gnupg             # GPG signatures
sudo apt install openssl           # Certificates
sudo apt install nginx             # HTTPS server
sudo apt install ufw               # Firewall
sudo apt install apparmor          # MAC
sudo apt install fail2ban          # IDS
sudo apt install openssh-server    # Secure shell
sudo apt install grub-pc           # GRUB bootloader
```

---

## TABLE 7: KEY TECHNOLOGIES BY IMPLEMENTATION EFFORT

| Effort Level | Technologies | Time to Deploy |
|---|---|---|
| **Critical (Day 1)** | sha256sum, AIDE, auditctl, UFW, chmod 444 | 1-2 hours |
| **High (Week 1)** | GPG signatures, HTTPS, GRUB password, sysctl | 4-8 hours |
| **Medium (Month 1)** | AppArmor, Secure Boot, TPM/IMA, rsyslog | 8-16 hours |
| **Advanced (Ongoing)** | SIEM integration, compliance scanning, threat hunting | Continuous |

---

## TABLE 8: EXPLOITATION SUCCESS FACTORS

| Factor | Tool/Technology | Why It Works |
|---|---|---|
| **Network Access** | ARP spoofing + tcpdump | No authentication on layer 2 |
| **File Manipulation** | gunzip + cpio + sed | Bootloader doesn't verify file integrity |
| **Persistence** | systemd + cron + LD_PRELOAD | Multiple auto-run mechanisms available |
| **Privilege Escalation** | SUID + sudoers modification | Root execution during boot |
| **Stealth** | auditctl -D + /dev/null redirection | Audit can be cleared, logs redirected |
| **Communication** | Netcat + SSH | Simple, reliable backdoor channels |

---

## SUMMARY STATISTICS

| Category | Count | Most Critical |
|---|---|---|
| **Exploitation Technologies** | 42 | ARP Spoofing, TFTP Hijacking, File Compromise |
| **Patching Technologies** | 65 | Integrity Monitoring, Digital Signatures, Secure Boot |
| **Network Security Tools** | 12 | UFW, VLAN, DHCP Snooping |
| **Cryptographic Tools** | 8 | GPG, OpenSSL, TLS 1.3 |
| **Monitoring/Detection Tools** | 10 | AIDE, auditctl, OSSEC |
| **Kernel Hardening Parameters** | 8 | sysrq=0, modules_disabled=1 |

This comprehensive reference covers **107 distinct technologies** used in netboot exploitation and patching strategies.